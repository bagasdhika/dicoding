/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const n="https://story-api.dicoding.dev/v1";function t(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(t,o,i,a){var c=o&&o.prototype instanceof f?o:f,s=Object.create(c.prototype);return e(s,"_invoke",function(t,e,o){var i,a,c,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,a=0,c=n,p.n=e,u}};function y(t,e){for(a=t,c=e,r=0;!l&&f&&!o&&r<s.length;r++){var o,i=s[r],y=p.p,d=i[2];t>3?(o=d===e)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=t<2&&y<i[1])?(a=0,p.v=e,p.n=i[1]):y<d&&(o=t<3||i[0]>e||e>d)&&(i[4]=t,i[5]=e,p.n=d,a=0))}if(o||t>1)return u;throw l=!0,e}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),a=s,c=d;(r=a<2?n:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),y(a,c)):p.n=c:p.v=c);try{if(f=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(l=p.n<0)?c:t.call(e,p))!==u)break}catch(t){i=n,a=1,c=t}finally{f=1}}return{value:r,done:l}}}(t,i,a),!0),s}var u={};function f(){}function s(){}function l(){}r=Object.getPrototypeOf;var p=[][i]?r(r([][i]())):(e(r={},i,(function(){return this})),r),y=l.prototype=f.prototype=Object.create(p);function d(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,l):(n.__proto__=l,e(n,a,"GeneratorFunction")),n.prototype=Object.create(y),n}return s.prototype=l,e(y,"constructor",l),e(l,"constructor",s),s.displayName="GeneratorFunction",e(l,a,"GeneratorFunction"),e(y),e(y,a,"Generator"),e(y,i,(function(){return this})),e(y,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:c,m:d}})()}function e(n,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}e=function(n,t,r,o){function a(t,r){e(n,t,(function(n){return this._invoke(t,r,n)}))}t?i?i(n,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):n[t]=r:(a("next",0),a("throw",1),a("return",2))},e(n,t,r,o)}function r(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function o(n){return function(){var t=this,e=arguments;return new Promise((function(o,i){var a=n.apply(t,e);function c(n){r(a,o,i,c,u,"next",n)}function u(n){r(a,o,i,c,u,"throw",n)}c(void 0)}))}}var i={REGISTER:"".concat(n,"/register"),LOGIN:"".concat(n,"/login"),STORIES:"".concat(n,"/stories"),STORIES_GUEST:"".concat(n,"/stories/guest"),NOTIFICATION:"".concat(n,"/notifications/subscribe")};function a(n){return c.apply(this,arguments)}function c(){return(c=o(t().m((function n(e){var r,o,a,c;return t().w((function(n){for(;;)switch(n.n){case 0:return r=e.name,o=e.email,a=e.password,n.n=1,fetch(i.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,password:a})});case 1:return c=n.v,n.a(2,c.json())}}),n)})))).apply(this,arguments)}function u(n){return f.apply(this,arguments)}function f(){return(f=o(t().m((function n(e){var r,o,a;return t().w((function(n){for(;;)switch(n.n){case 0:return r=e.email,o=e.password,n.n=1,fetch(i.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:o})});case 1:return a=n.v,n.a(2,a.json())}}),n)})))).apply(this,arguments)}function s(n){return l.apply(this,arguments)}function l(){return l=o(t().m((function n(e){var r,o,a,c=arguments;return t().w((function(n){for(;;)switch(n.n){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:1,o=c.length>2&&void 0!==c[2]?c[2]:10,n.n=1,fetch("".concat(i.STORIES,"?page=").concat(r,"&size=").concat(o,"&location=1"),{headers:{Authorization:"Bearer ".concat(e)}});case 1:return a=n.v,n.a(2,a.json())}}),n)}))),l.apply(this,arguments)}function p(n,t){return y.apply(this,arguments)}function y(){return(y=o(t().m((function n(e,r){var o;return t().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,fetch("".concat(i.STORIES,"/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}});case 1:return o=n.v,n.a(2,o.json())}}),n)})))).apply(this,arguments)}function d(n,t){return v.apply(this,arguments)}function v(){return(v=o(t().m((function n(e,r){var o;return t().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,fetch(i.STORIES,{method:"POST",headers:{Authorization:"Bearer ".concat(r)},body:e});case 1:return o=n.v,n.a(2,o.json())}}),n)})))).apply(this,arguments)}var m=function(n){var t,e;if(!n)return null;var r=n.toJSON();return{endpoint:r.endpoint,keys:{p256dh:null===(t=r.keys)||void 0===t?void 0:t.p256dh,auth:null===(e=r.keys)||void 0===e?void 0:e.auth}}};function b(n,t){return h.apply(this,arguments)}function h(){return(h=o(t().m((function n(e,r){var o,a;return t().w((function(n){for(;;)switch(n.n){case 0:if(o=m(e)){n.n=1;break}throw new Error("Subscription tidak valid");case 1:return n.n=2,fetch(i.NOTIFICATION,{method:"POST",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify(o)});case 2:return a=n.v,n.a(2,a.json())}}),n)})))).apply(this,arguments)}function g(n,t){return w.apply(this,arguments)}function w(){return(w=o(t().m((function n(e,r){var o;return t().w((function(n){for(;;)switch(n.n){case 0:if(e){n.n=1;break}throw new Error("Endpoint tidak valid");case 1:return n.n=2,fetch(i.NOTIFICATION,{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({endpoint:e})});case 2:return o=n.v,n.a(2,o.json())}}),n)})))).apply(this,arguments)}var k=function(){return localStorage.getItem("token")},S="toast-container",O=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",e=function(){var n=document.getElementById(S);return n||((n=document.createElement("div")).id=S,n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic","true"),document.body.appendChild(n)),n}(),r=document.createElement("div");r.className="toast toast-".concat(t),r.setAttribute("role","status"),r.tabIndex=0,r.innerHTML="\n    <span>".concat(n,'</span>\n    <button aria-label="Tutup notifikasi">&times;</button>\n  ');var o=function(){r.classList.add("hide"),setTimeout((function(){return r.remove()}),300)};r.querySelector("button").addEventListener("click",o),e.appendChild(r),setTimeout(o,3e3)};function j(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return E(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(E(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,E(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,E(l,"constructor",f),E(f,"constructor",u),u.displayName="GeneratorFunction",E(f,o,"GeneratorFunction"),E(l),E(l,o,"Generator"),E(l,r,(function(){return this})),E(l,"toString",(function(){return"[object Generator]"})),(j=function(){return{w:i,m:p}})()}function E(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}E=function(n,t,e,r){function i(t,e){E(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},E(n,t,e,r)}function T(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function P(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){T(i,r,o,a,c,"next",n)}function c(n){T(i,r,o,a,c,"throw",n)}a(void 0)}))}}var I=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window},B=function(){var n=P(j().m((function n(){var t;return j().w((function(n){for(;;)switch(n.n){case 0:if("Notification"in window){n.n=1;break}return alert("Browser tidak mendukung notifikasi"),n.a(2,!1);case 1:return n.n=2,Notification.requestPermission();case 2:return t=n.v,n.a(2,"granted"===t)}}),n)})));return function(){return n.apply(this,arguments)}}(),G=function(n){for(var t=(n+"=".repeat((4-n.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),e=atob(t),r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r},_=function(){var n=P(j().m((function n(){var t;return j().w((function(n){for(;;)switch(n.n){case 0:if(I()){n.n=1;break}return n.a(2,null);case 1:return n.n=2,navigator.serviceWorker.ready;case 2:return t=n.v,n.a(2,t.pushManager.getSubscription())}}),n)})));return function(){return n.apply(this,arguments)}}(),x=function(){var n=P(j().m((function n(){var t,e;return j().w((function(n){for(;;)switch(n.n){case 0:if(I()){n.n=1;break}throw new Error("Push Notification tidak didukung browser");case 1:return n.n=2,B();case 2:if(n.v){n.n=3;break}throw new Error("Izin notifikasi tidak diberikan");case 3:return n.n=4,navigator.serviceWorker.ready;case 4:return t=n.v,n.n=5,t.pushManager.getSubscription();case 5:if(e=n.v){n.n=7;break}return n.n=6,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:G("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk")});case 6:e=n.v;case 7:return n.a(2,e)}}),n)})));return function(){return n.apply(this,arguments)}}(),F=function(){var n=P(j().m((function n(){var t,e;return j().w((function(n){for(;;)switch(n.p=n.n){case 0:return n.n=1,_();case 1:if(t=n.v){n.n=2;break}return n.a(2,!1);case 2:return n.p=2,n.n=3,t.unsubscribe();case 3:return n.a(2,!0);case 4:return n.p=4,e=n.v,console.error("Unsubscribe gagal:",e),n.a(2,!1)}}),n,null,[[2,4]])})));return function(){return n.apply(this,arguments)}}();function D(n){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},D(n)}function N(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return C(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(C(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,C(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,C(l,"constructor",f),C(f,"constructor",u),u.displayName="GeneratorFunction",C(f,o,"GeneratorFunction"),C(l),C(l,o,"Generator"),C(l,r,(function(){return this})),C(l,"toString",(function(){return"[object Generator]"})),(N=function(){return{w:i,m:p}})()}function C(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}C=function(n,t,e,r){function i(t,e){C(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},C(n,t,e,r)}function A(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function M(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){A(i,r,o,a,c,"next",n)}function c(n){A(i,r,o,a,c,"throw",n)}a(void 0)}))}}function R(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,H(r.key),r)}}function H(n){var t=function(n){if("object"!=D(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=D(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==D(t)?t:t+""}var q=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=M(N().m((function n(){return N().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="container">\n        <h1 class="page-title">Daftar Story</h1>\n\n        <div class="push-buttons">\n          <button id="btn-subscribe">Aktifkan Notifikasi</button>\n          <button id="btn-unsubscribe">Nonaktifkan Notifikasi</button>\n        </div>\n\n        <div id="map" style="height:400px;margin:20px 0"></div>\n\n        <section id="storyList" class="story-list"></section>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=M(N().m((function n(){var t,e,r,o,i,a;return N().w((function(n){for(;;)switch(n.n){case 0:if(t=k()){n.n=1;break}return location.hash="#/login",n.a(2);case 1:return I()&&(null===(e=document.getElementById("btn-subscribe"))||void 0===e||e.addEventListener("click",M(N().m((function n(){var e,r;return N().w((function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,x();case 1:return e=n.v,n.n=2,b(e,t);case 2:O("Push aktif!","success"),n.n=4;break;case 3:n.p=3,r=n.v,O(r.message,"error");case 4:return n.a(2)}}),n,null,[[0,3]])})))),null===(r=document.getElementById("btn-unsubscribe"))||void 0===r||r.addEventListener("click",M(N().m((function n(){var e,r;return N().w((function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,_();case 1:if(e=n.v){n.n=2;break}return n.a(2);case 2:return n.n=3,g(e.endpoint,t);case 3:return n.n=4,F();case 4:O("Push dimatikan","info"),n.n=6;break;case 5:n.p=5,r=n.v,O(r.message,"error");case 6:return n.a(2)}}),n,null,[[0,5]])}))))),o=L.map("map").setView([-6.2,106.8],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(o),i=document.getElementById("storyList"),n.n=2,s(t);case 2:a=n.v,i.innerHTML="",a.listStory.forEach((function(n){var t=document.createElement("article");t.className="story-card",t.innerHTML="\n        <h2>".concat(n.name,'</h2>\n        <img src="').concat(n.photoUrl,'" />\n        <p>').concat(n.description,'</p>\n        <a href="#/detail/').concat(n.id,'" class="btn">Detail</a>\n      '),n.lat&&n.lon&&L.marker([n.lat,n.lon]).addTo(o).bindPopup(n.name),i.appendChild(t)}));case 3:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&R(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}();function z(n){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},z(n)}function W(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return K(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(K(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,K(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,K(l,"constructor",f),K(f,"constructor",u),u.displayName="GeneratorFunction",K(f,o,"GeneratorFunction"),K(l),K(l,o,"Generator"),K(l,r,(function(){return this})),K(l,"toString",(function(){return"[object Generator]"})),(W=function(){return{w:i,m:p}})()}function K(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}K=function(n,t,e,r){function i(t,e){K(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},K(n,t,e,r)}function V(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function U(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){V(i,r,o,a,c,"next",n)}function c(n){V(i,r,o,a,c,"throw",n)}a(void 0)}))}}function J(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Y(r.key),r)}}function Y(n){var t=function(n){if("object"!=z(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=z(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==z(t)?t:t+""}var Q=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=U(W().m((function n(){return W().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="auth-container">\n        <h1>Login</h1>\n\n        <form id="loginForm" class="auth-form">\n          <label for="loginEmail">Email</label>\n          <input\n            type="email"\n            id="loginEmail"\n            required\n            autocomplete="username"\n          />\n\n          <label for="loginPassword">Password</label>\n          <input\n            type="password"\n            id="loginPassword"\n            required\n            minlength="8"\n            autocomplete="current-password"\n          />\n\n          <button type="submit" class="btn-primary">\n            Login\n          </button>\n        </form>\n\n        <p class="auth-switch">\n          Belum punya akun?\n          <a href="#/register" class="link-button">Daftar</a>\n        </p>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=U(W().m((function n(){return W().w((function(n){for(;;)switch(n.n){case 0:document.getElementById("loginForm").addEventListener("submit",function(){var n=U(W().m((function n(t){var e,r,o,i;return W().w((function(n){for(;;)switch(n.p=n.n){case 0:return t.preventDefault(),e=document.getElementById("loginEmail").value,r=document.getElementById("loginPassword").value,n.p=1,n.n=2,u({email:e,password:r});case 2:if(!(o=n.v).error){n.n=3;break}return alert(o.message),n.a(2);case 3:localStorage.setItem("token",o.loginResult.token),localStorage.setItem("name",o.loginResult.name),location.hash="#/",n.n=5;break;case 4:n.p=4,i=n.v,alert("Login gagal"),console.error(i);case 5:return n.a(2)}}),n,null,[[1,4]])})));return function(t){return n.apply(this,arguments)}}());case 1:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&J(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}();function $(n){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$(n)}function X(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Z(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Z(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Z(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Z(l,"constructor",f),Z(f,"constructor",u),u.displayName="GeneratorFunction",Z(f,o,"GeneratorFunction"),Z(l),Z(l,o,"Generator"),Z(l,r,(function(){return this})),Z(l,"toString",(function(){return"[object Generator]"})),(X=function(){return{w:i,m:p}})()}function Z(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Z=function(n,t,e,r){function i(t,e){Z(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Z(n,t,e,r)}function nn(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function tn(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){nn(i,r,o,a,c,"next",n)}function c(n){nn(i,r,o,a,c,"throw",n)}a(void 0)}))}}function en(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,rn(r.key),r)}}function rn(n){var t=function(n){if("object"!=$(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=$(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==$(t)?t:t+""}var on=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=tn(X().m((function n(){return X().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="auth-container">\n        <h1>Register</h1>\n\n        <form id="registerForm" class="auth-form">\n          <label for="regName">Nama</label>\n          <input\n            type="text"\n            id="regName"\n            required\n          />\n\n          <label for="regEmail">Email</label>\n          <input\n            type="email"\n            id="regEmail"\n            required\n            autocomplete="username"\n          />\n\n          <label for="regPassword">Password</label>\n          <input\n            type="password"\n            id="regPassword"\n            required\n            minlength="8"\n            autocomplete="new-password"\n          />\n\n          <button type="submit" class="btn-primary">\n            Daftar\n          </button>\n        </form>\n\n        <p class="auth-switch">\n          Sudah punya akun?\n          <a href="#/login" class="link-button">Login</a>\n        </p>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=tn(X().m((function n(){return X().w((function(n){for(;;)switch(n.n){case 0:document.getElementById("registerForm").addEventListener("submit",function(){var n=tn(X().m((function n(t){var e,r,o,i,c;return X().w((function(n){for(;;)switch(n.p=n.n){case 0:return t.preventDefault(),e=document.getElementById("regName").value,r=document.getElementById("regEmail").value,o=document.getElementById("regPassword").value,n.p=1,n.n=2,a({name:e,email:r,password:o});case 2:if(!(i=n.v).error){n.n=3;break}return alert(i.message),n.a(2);case 3:alert("Registrasi berhasil, silakan login"),location.hash="#/login",n.n=5;break;case 4:n.p=4,c=n.v,alert("Registrasi gagal"),console.error(c);case 5:return n.a(2)}}),n,null,[[1,4]])})));return function(t){return n.apply(this,arguments)}}());case 1:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&en(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}();const an=(n,t)=>t.some((t=>n instanceof t));let cn,un;const fn=new WeakMap,sn=new WeakMap,ln=new WeakMap;let pn={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return fn.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return vn(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function yn(n){pn=n(pn)}function dn(n){return"function"==typeof n?(t=n,(un||(un=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...n){return t.apply(mn(this),n),vn(this.request)}:function(...n){return vn(t.apply(mn(this),n))}):(n instanceof IDBTransaction&&function(n){if(fn.has(n))return;const t=new Promise(((t,e)=>{const r=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",i),n.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{e(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",o),n.addEventListener("error",i),n.addEventListener("abort",i)}));fn.set(n,t)}(n),an(n,cn||(cn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(n,pn):n);var t}function vn(n){if(n instanceof IDBRequest)return function(n){const t=new Promise(((t,e)=>{const r=()=>{n.removeEventListener("success",o),n.removeEventListener("error",i)},o=()=>{t(vn(n.result)),r()},i=()=>{e(n.error),r()};n.addEventListener("success",o),n.addEventListener("error",i)}));return ln.set(t,n),t}(n);if(sn.has(n))return sn.get(n);const t=dn(n);return t!==n&&(sn.set(n,t),ln.set(t,n)),t}const mn=n=>ln.get(n),bn=["get","getKey","getAll","getAllKeys","count"],hn=["put","add","delete","clear"],gn=new Map;function wn(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(gn.get(t))return gn.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,o=hn.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!bn.includes(e))return;const i=async function(n,...t){const i=this.transaction(n,o?"readwrite":"readonly");let a=i.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[e](...t),o&&i.done]))[0]};return gn.set(t,i),i}yn((n=>({...n,get:(t,e,r)=>wn(t,e)||n.get(t,e,r),has:(t,e)=>!!wn(t,e)||n.has(t,e)})));const kn=["continue","continuePrimaryKey","advance"],Sn={},On=new WeakMap,jn=new WeakMap,En={get(n,t){if(!kn.includes(t))return n[t];let e=Sn[t];return e||(e=Sn[t]=function(...n){On.set(this,jn.get(this)[t](...n))}),e}};async function*Tn(...n){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...n)),!t)return;const e=new Proxy(t,En);for(jn.set(e,t),ln.set(e,mn(t));t;)yield e,t=await(On.get(e)||t.continue()),On.delete(e)}function Pn(n,t){return t===Symbol.asyncIterator&&an(n,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&an(n,[IDBIndex,IDBObjectStore])}function In(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Bn(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Bn(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Bn(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Bn(l,"constructor",f),Bn(f,"constructor",u),u.displayName="GeneratorFunction",Bn(f,o,"GeneratorFunction"),Bn(l),Bn(l,o,"Generator"),Bn(l,r,(function(){return this})),Bn(l,"toString",(function(){return"[object Generator]"})),(In=function(){return{w:i,m:p}})()}function Bn(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Bn=function(n,t,e,r){function i(t,e){Bn(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Bn(n,t,e,r)}function Gn(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function _n(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){Gn(i,r,o,a,c,"next",n)}function c(n){Gn(i,r,o,a,c,"throw",n)}a(void 0)}))}}yn((n=>({...n,get:(t,e,r)=>Pn(t,e)?Tn:n.get(t,e,r),has:(t,e)=>Pn(t,e)||n.has(t,e)})));var Ln="offline-stories",xn=function(n,t,{blocked:e,upgrade:r,blocking:o,terminated:i}={}){const a=indexedDB.open(n,t),c=vn(a);return r&&a.addEventListener("upgradeneeded",(n=>{r(vn(a.result),n.oldVersion,n.newVersion,vn(a.transaction),n)})),e&&a.addEventListener("blocked",(n=>e(n.oldVersion,n.newVersion,n))),c.then((n=>{i&&n.addEventListener("close",(()=>i())),o&&n.addEventListener("versionchange",(n=>o(n.oldVersion,n.newVersion,n)))})).catch((()=>{})),c}("dicoding-story-db",1,{upgrade:function(n){n.objectStoreNames.contains(Ln)||n.createObjectStore(Ln,{keyPath:"id"})}});const Fn={addStory:function(n){return _n(In().m((function t(){var e;return In().w((function(t){for(;;)switch(t.n){case 0:if(n&&n.id){t.n=1;break}return t.a(2);case 1:return t.n=2,xn;case 2:return e=t.v,t.a(2,e.put(Ln,n))}}),t)})))()},getAllStories:function(){return _n(In().m((function n(){var t;return In().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,xn;case 1:return t=n.v,n.a(2,t.getAll(Ln))}}),n)})))()},getStoryById:function(n){return _n(In().m((function t(){var e;return In().w((function(t){for(;;)switch(t.n){case 0:if(n){t.n=1;break}return t.a(2,null);case 1:return t.n=2,xn;case 2:return e=t.v,t.a(2,e.get(Ln,n))}}),t)})))()},deleteStory:function(n){return _n(In().m((function t(){var e;return In().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,xn;case 1:return e=t.v,t.a(2,e.delete(Ln,n))}}),t)})))()},clearStories:function(){return _n(In().m((function n(){var t;return In().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,xn;case 1:return t=n.v,n.a(2,t.clear(Ln))}}),n)})))()},save:function(n){var t=this;return _n(In().m((function e(){return In().w((function(e){for(;;)if(0===e.n)return e.a(2,t.addStory(n))}),e)})))()},getAll:function(){var n=this;return _n(In().m((function t(){return In().w((function(t){for(;;)if(0===t.n)return t.a(2,n.getAllStories())}),t)})))()},get:function(n){var t=this;return _n(In().m((function e(){return In().w((function(e){for(;;)if(0===e.n)return e.a(2,t.getStoryById(n))}),e)})))()},delete:function(n){var t=this;return _n(In().m((function e(){return In().w((function(e){for(;;)if(0===e.n)return e.a(2,t.deleteStory(n))}),e)})))()}};function Dn(n){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Dn(n)}function Nn(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Cn(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Cn(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Cn(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Cn(l,"constructor",f),Cn(f,"constructor",u),u.displayName="GeneratorFunction",Cn(f,o,"GeneratorFunction"),Cn(l),Cn(l,o,"Generator"),Cn(l,r,(function(){return this})),Cn(l,"toString",(function(){return"[object Generator]"})),(Nn=function(){return{w:i,m:p}})()}function Cn(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Cn=function(n,t,e,r){function i(t,e){Cn(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Cn(n,t,e,r)}function An(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function Mn(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){An(i,r,o,a,c,"next",n)}function c(n){An(i,r,o,a,c,"throw",n)}a(void 0)}))}}function Rn(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Hn(r.key),r)}}function Hn(n){var t=function(n){if("object"!=Dn(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=Dn(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==Dn(t)?t:t+""}function qn(n){var t=n.split("/");return{resource:t[1]||null,id:t[2]||null}}function zn(){return location.hash.replace("#","")||"/"}function Wn(n){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wn(n)}function Kn(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Vn(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Vn(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Vn(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Vn(l,"constructor",f),Vn(f,"constructor",u),u.displayName="GeneratorFunction",Vn(f,o,"GeneratorFunction"),Vn(l),Vn(l,o,"Generator"),Vn(l,r,(function(){return this})),Vn(l,"toString",(function(){return"[object Generator]"})),(Kn=function(){return{w:i,m:p}})()}function Vn(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Vn=function(n,t,e,r){function i(t,e){Vn(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Vn(n,t,e,r)}function Un(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function Jn(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){Un(i,r,o,a,c,"next",n)}function c(n){Un(i,r,o,a,c,"throw",n)}a(void 0)}))}}function Yn(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Qn(r.key),r)}}function Qn(n){var t=function(n){if("object"!=Wn(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=Wn(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==Wn(t)?t:t+""}function $n(n){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$n(n)}function Xn(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Zn(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Zn(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Zn(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Zn(l,"constructor",f),Zn(f,"constructor",u),u.displayName="GeneratorFunction",Zn(f,o,"GeneratorFunction"),Zn(l),Zn(l,o,"Generator"),Zn(l,r,(function(){return this})),Zn(l,"toString",(function(){return"[object Generator]"})),(Xn=function(){return{w:i,m:p}})()}function Zn(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Zn=function(n,t,e,r){function i(t,e){Zn(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Zn(n,t,e,r)}function nt(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function tt(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){nt(i,r,o,a,c,"next",n)}function c(n){nt(i,r,o,a,c,"throw",n)}a(void 0)}))}}function et(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,rt(r.key),r)}}function rt(n){var t=function(n){if("object"!=$n(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=$n(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==$n(t)?t:t+""}const ot={"/":q,"/login":Q,"/register":on,"/add":function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=Mn(Nn().m((function n(){return Nn().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="container">\n        <h1 class="page-title">Tambah Cerita</h1>\n\n        <form id="addStoryForm" class="story-form">\n\n          \x3c!-- DESKRIPSI --\x3e\n          <label for="description">Deskripsi Cerita</label>\n          <textarea\n            id="description"\n            name="description"\n            required\n            aria-required="true"\n            placeholder="Ceritakan pengalamanmu..."\n          ></textarea>\n\n          \x3c!-- FOTO --\x3e\n          <label for="photo">Foto</label>\n          <input\n            type="file"\n            id="photo"\n            name="photo"\n            accept="image/*"\n            aria-describedby="photoHelp"\n          />\n          <small id="photoHelp">Bisa dari galeri atau kamera</small>\n\n          \x3c!-- KAMERA --\x3e\n          <div class="camera-control">\n            <button type="button" id="cameraBtn">ðŸ“· Gunakan Kamera</button>\n            <button type="button" id="captureBtn" hidden>Ambil Foto</button>\n          </div>\n\n          <video\n            id="cameraPreview"\n            autoplay\n            playsinline\n            hidden\n            aria-label="Preview kamera"\n          ></video>\n\n          \x3c!-- MAP --\x3e\n          <label>Pilih Lokasi</label>\n          <div id="map"></div>\n          <p id="locationInfo" class="location-info">\n            Klik peta untuk menentukan lokasi\n          </p>\n\n          <button type="submit" class="btn-primary">\n            Posting Cerita\n          </button>\n        </form>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=Mn(Nn().m((function n(){var t,e,r,o,i,a,c,u,f,s,l,p;return Nn().w((function(n){for(;;)switch(n.n){case 0:if(t=localStorage.getItem("token")){n.n=1;break}return location.hash="#/login",n.a(2);case 1:e=L.map("map").setView([-6.2,106.8],5),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap"}).addTo(e),r=null,o=null,i=null,e.on("click",(function(n){r=n.latlng.lat,o=n.latlng.lng,i&&e.removeLayer(i),i=L.marker(n.latlng).addTo(e),document.getElementById("locationInfo").textContent="Lokasi: ".concat(r.toFixed(4),", ").concat(o.toFixed(4))})),a=document.getElementById("cameraBtn"),c=document.getElementById("captureBtn"),u=document.getElementById("cameraPreview"),f=document.getElementById("photo"),s=null,l=function(){var n=Mn(Nn().m((function n(){var t;return Nn().w((function(n){for(;;)switch(n.p=n.n){case 0:if(null!==(t=navigator.mediaDevices)&&void 0!==t&&t.getUserMedia){n.n=1;break}return O("Browser tidak mendukung kamera","error"),n.a(2);case 1:return n.p=1,n.n=2,navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1});case 2:s=n.v,u.srcObject=s,u.hidden=!1,c.hidden=!1,n.n=4;break;case 3:n.p=3,n.v,O("Izin kamera ditolak","error");case 4:return n.a(2)}}),n,null,[[1,3]])})));return function(){return n.apply(this,arguments)}}(),p=function(){s&&(s.getTracks().forEach((function(n){return n.stop()})),s=null),u.hidden=!0,c.hidden=!0},a.addEventListener("click",l),c.addEventListener("click",(function(){var n=document.createElement("canvas");n.width=u.videoWidth,n.height=u.videoHeight,n.getContext("2d").drawImage(u,0,0),n.toBlob((function(n){var t=new File([n],"camera.jpg",{type:"image/jpeg",lastModified:Date.now()}),e=new DataTransfer;e.items.add(t),f.files=e.files}),"image/jpeg",.8),p()})),window.addEventListener("hashchange",(function(){return p()}),{once:!0}),document.getElementById("addStoryForm").addEventListener("submit",function(){var n=Mn(Nn().m((function n(e){var i,a,c,u;return Nn().w((function(n){for(;;)switch(n.p=n.n){case 0:return e.preventDefault(),i=document.getElementById("description").value,a=f.files[0],(c=new FormData).append("description",i),a&&c.append("photo",a),null!==r&&null!==o&&(c.append("lat",r),c.append("lon",o)),n.p=1,n.n=2,d(c,t);case 2:u=n.v,O(u.message,"success"),location.hash="#/",n.n=5;break;case 3:return n.p=3,n.v,n.n=4,Fn.addStory({description:i,photo:a,lat:r,lon:o,createdAt:(new Date).toISOString()});case 4:O("Offline: cerita disimpan & akan dikirim saat online","info"),location.hash="#/";case 5:return n.a(2)}}),n,null,[[1,3]])})));return function(t){return n.apply(this,arguments)}}());case 2:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&Rn(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}(),"/detail/:id":function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=Jn(Kn().m((function n(){return Kn().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="container">\n        <div id="storyDetail"></div>\n        <button id="bookmarkBtn" class="btn">Simpan Bookmark</button>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=Jn(Kn().m((function n(){var t,e,r,o,i,a,c,u,f;return Kn().w((function(n){for(;;)switch(n.p=n.n){case 0:if(t=qn(zn()),e=t.id,r=document.getElementById("storyDetail"),o=document.getElementById("bookmarkBtn"),i=k()){n.n=1;break}return location.hash="#/login",n.a(2);case 1:if(e){n.n=2;break}return r.innerHTML="<p>Story tidak ditemukan</p>",n.a(2);case 2:return n.p=2,n.n=3,p(e,i);case 3:return a=n.v,c=a.story,r.innerHTML="\n        <h1>".concat(c.name,'</h1>\n        <img src="').concat(c.photoUrl,'" alt="').concat(c.name,'" />\n        <p>').concat(c.description,"</p>\n        <small>").concat(new Date(c.createdAt).toLocaleString(),"</small>\n      "),n.n=4,Fn.get(c.id);case 4:u=n.v,o.textContent=u?"Hapus Bookmark":"Simpan Bookmark",o.addEventListener("click",Jn(Kn().m((function n(){return Kn().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,Fn.get(c.id);case 1:if(!n.v){n.n=3;break}return n.n=2,Fn.delete(c.id);case 2:o.textContent="Simpan Bookmark",O("Bookmark dihapus","info"),n.n=5;break;case 3:return n.n=4,Fn.save(c);case 4:o.textContent="Hapus Bookmark",O("Bookmark disimpan","success");case 5:return n.a(2)}}),n)})))),n.n=6;break;case 5:n.p=5,f=n.v,console.error(f),r.innerHTML="<p>Gagal memuat detail story</p>";case 6:return n.a(2)}}),n,null,[[2,5]])}))),function(){return e.apply(this,arguments)})}],t&&Yn(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}(),"/bookmark":function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=tt(Xn().m((function n(){return Xn().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="container">\n        <h1>Story Tersimpan</h1>\n        <section id="bookmarkList" class="story-list"></section>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=tt(Xn().m((function n(){var t,e;return Xn().w((function(n){for(;;)switch(n.n){case 0:return t=document.getElementById("bookmarkList"),n.n=1,Fn.getAll();case 1:if((e=n.v).length){n.n=2;break}return t.innerHTML="<p>Belum ada bookmark</p>",n.a(2);case 2:e.forEach((function(n){var e=document.createElement("article");e.className="story-card",e.innerHTML="\n        <h2>".concat(n.name,'</h2>\n        <img src="').concat(n.photoUrl,'" alt="').concat(n.name,'" />\n        <p>').concat(n.description,'</p>\n\n        <a href="#/detail/').concat(n.id,'" class="btn">Detail</a>\n        <button class="btn danger">Hapus</button>\n      '),e.querySelector(".danger").addEventListener("click",tt(Xn().m((function t(){return Xn().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,Fn.delete(n.id);case 1:e.remove(),O("Bookmark dihapus","info");case 2:return t.a(2)}}),t)})))),t.appendChild(e)}));case 3:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&et(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}()};function it(n){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},it(n)}function at(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return ct(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(ct(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,ct(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,ct(l,"constructor",f),ct(f,"constructor",u),u.displayName="GeneratorFunction",ct(f,o,"GeneratorFunction"),ct(l),ct(l,o,"Generator"),ct(l,r,(function(){return this})),ct(l,"toString",(function(){return"[object Generator]"})),(at=function(){return{w:i,m:p}})()}function ct(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}ct=function(n,t,e,r){function i(t,e){ct(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},ct(n,t,e,r)}function ut(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function ft(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){ut(i,r,o,a,c,"next",n)}function c(n){ut(i,r,o,a,c,"throw",n)}a(void 0)}))}}function st(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,lt(r.key),r)}}function lt(n){var t=function(n){if("object"!=it(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=it(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==it(t)?t:t+""}var pt=function(){return n=function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)},t=[{key:"render",value:(r=ft(at().m((function n(){return at().w((function(n){for(;;)if(0===n.n)return n.a(2,'\n      <section class="container not-found-page">\n        <h1 tabindex="0">404 - Not Found</h1>\n\n        <p>\n          Halaman yang kamu tuju tidak ditemukan.\n        </p>\n\n        <a href="#/" class="btn-primary">\n          Kembali ke Beranda\n        </a>\n      </section>\n    ')}),n)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(e=ft(at().m((function n(){var t;return at().w((function(n){for(;;)switch(n.n){case 0:(t=document.querySelector(".not-found-page h1"))&&t.focus();case 1:return n.a(2)}}),n)}))),function(){return e.apply(this,arguments)})}],t&&st(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e,r}();function yt(n){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},yt(n)}function dt(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return vt(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(vt(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,vt(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,vt(l,"constructor",f),vt(f,"constructor",u),u.displayName="GeneratorFunction",vt(f,o,"GeneratorFunction"),vt(l),vt(l,o,"Generator"),vt(l,r,(function(){return this})),vt(l,"toString",(function(){return"[object Generator]"})),(dt=function(){return{w:i,m:p}})()}function vt(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}vt=function(n,t,e,r){function i(t,e){vt(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},vt(n,t,e,r)}function mt(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function bt(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){mt(i,r,o,a,c,"next",n)}function c(n){mt(i,r,o,a,c,"throw",n)}a(void 0)}))}}function ht(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,gt(r.key),r)}}function gt(n){var t=function(n){if("object"!=yt(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=yt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==yt(t)?t:t+""}var wt=function(){return n=function n(t){var e=t.content;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._content=e},t=[{key:"renderPage",value:(e=bt(dt().m((function n(){var t,e,r=this;return dt().w((function(n){for(;;)switch(n.n){case 0:if(i=void 0,i="",(o=qn(zn())).resource&&(i+="/".concat(o.resource)),o.id&&(i+="/:id"),t=new(ot[i||"/"]||pt),e=function(){var n=bt(dt().m((function n(){return dt().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,t.render();case 1:return r._content.innerHTML=n.v,n.n=2,t.afterRender();case 2:e=void 0,(e=document.getElementById("nav-list"))&&(localStorage.getItem("token")?(e.innerHTML='\n      <li><a href="#/">Beranda</a></li>\n      <li><a href="#/add">Tambah Cerita</a></li>\n      <li><a href="#/bookmark">Bookmark</a></li>\n      <li>\n        <button id="logoutBtn" class="logout-btn">Logout</button>\n      </li>\n    ',document.getElementById("logoutBtn").addEventListener("click",(function(){localStorage.removeItem("token"),location.hash="#/login"}))):e.innerHTML='\n      <li><a href="#/login">Login</a></li>\n      <li><a href="#/register">Register</a></li>\n    ');case 3:return n.a(2)}var e}),n)})));return function(){return n.apply(this,arguments)}}(),!document.startViewTransition){n.n=1;break}document.startViewTransition(bt(dt().m((function n(){return dt().w((function(n){for(;;)switch(n.n){case 0:return n.n=1,e();case 1:return n.a(2)}}),n)})))),n.n=2;break;case 1:return this._content.animate([{opacity:0,transform:"translateY(8px)"},{opacity:1,transform:"translateY(0)"}],{duration:250,easing:"ease-out"}),n.n=2,e();case 2:return n.a(2)}var o,i}),n,this)}))),function(){return e.apply(this,arguments)})}],t&&ht(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,t,e}(),kt=function(){navigator.onLine?O("Kembali online","success"):O("Anda sedang offline","warning")};function St(){var n,t,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,f=Object.create(u.prototype);return Ot(f,"_invoke",function(e,r,o){var i,c,u,f=0,s=o||[],l=!1,p={p:0,n:0,v:n,a:y,f:y.bind(n,4),d:function(t,e){return i=t,c=0,u=n,p.n=e,a}};function y(e,r){for(c=e,u=r,t=0;!l&&f&&!o&&t<s.length;t++){var o,i=s[t],y=p.p,d=i[2];e>3?(o=d===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=n):i[0]<=y&&((o=e<2&&y<i[1])?(c=0,p.v=r,p.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,p.n=d,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,s,d){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&y(s,d),c=s,u=d;(t=c<2?n:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),y(c,u)):p.n=u:p.v=u);try{if(f=2,i){if(c||(o="next"),t=i[o]){if(!(t=t.call(i,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((t=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(t){i=n,c=1,u=t}finally{f=1}}return{value:t,done:l}}}(e,o,i),!0),f}var a={};function c(){}function u(){}function f(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Ot(t={},r,(function(){return this})),t),l=f.prototype=c.prototype=Object.create(s);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,f):(n.__proto__=f,Ot(n,o,"GeneratorFunction")),n.prototype=Object.create(l),n}return u.prototype=f,Ot(l,"constructor",f),Ot(f,"constructor",u),u.displayName="GeneratorFunction",Ot(f,o,"GeneratorFunction"),Ot(l),Ot(l,o,"Generator"),Ot(l,r,(function(){return this})),Ot(l,"toString",(function(){return"[object Generator]"})),(St=function(){return{w:i,m:p}})()}function Ot(n,t,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}Ot=function(n,t,e,r){function i(t,e){Ot(n,t,(function(n){return this._invoke(t,e,n)}))}t?o?o(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(i("next",0),i("throw",1),i("return",2))},Ot(n,t,e,r)}function jt(n,t,e,r,o,i,a){try{var c=n[i](a),u=c.value}catch(n){return void e(n)}c.done?t(u):Promise.resolve(u).then(r,o)}function Et(n){return function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(n){jt(i,r,o,a,c,"next",n)}function c(n){jt(i,r,o,a,c,"throw",n)}a(void 0)}))}}var Tt=function(){var n=document.getElementById("navList"),t=localStorage.getItem("token");n&&(t?(n.innerHTML='\n      <li><a href="#/">Beranda</a></li>\n      <li><a href="#/add">Tambah Story</a></li>\n      <li><a href="#/bookmark">Bookmark</a></li>\n      <li>\n        <button\n          id="toggleNotifBtn"\n          aria-pressed="false"\n          type="button"\n        >\n          ðŸ”” Aktifkan Notifikasi\n        </button>\n      </li>\n      <li><button id="logoutBtn">Logout</button></li>\n    ',document.getElementById("logoutBtn").addEventListener("click",(function(){localStorage.clear(),location.hash="#/login",location.reload()}))):n.innerHTML='\n      <li><a href="#/login">Login</a></li>\n      <li><a href="#/register">Register</a></li>\n    ')};document.addEventListener("DOMContentLoaded",Et(St().m((function n(){var t;return St().w((function(n){for(;;)switch(n.n){case 0:return window.addEventListener("offline",kt),window.addEventListener("online",kt),t=new wt({content:document.querySelector("#main-content")}),Tt(),n.n=1,t.renderPage();case 1:window.addEventListener("hashchange",Et(St().m((function n(){return St().w((function(n){for(;;)switch(n.n){case 0:return Tt(),n.n=1,t.renderPage();case 1:return n.a(2)}}),n)}))));case 2:return n.a(2)}}),n)})))),"serviceWorker"in navigator&&window.addEventListener("load",Et(St().m((function n(){var t;return St().w((function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,navigator.serviceWorker.register("/sw.js");case 1:console.log("Service Worker registered"),n.n=3;break;case 2:n.p=2,t=n.v,console.error("Service Worker registration failed:",t);case 3:return n.a(2)}}),n,null,[[0,2]])})))),window.addEventListener("click",function(){var n=Et(St().m((function n(t){return St().w((function(n){for(;;)switch(n.n){case 0:if("toggleNotifBtn"===t.target.id){n.n=1;break}return n.a(2);case 1:return n.n=2,B();case 2:if(n.v){n.n=3;break}return alert("Izin notifikasi ditolak"),n.a(2);case 3:alert("Izin notifikasi diberikan. Silakan aktifkan dari halaman Beranda.");case 4:return n.a(2)}}),n)})));return function(t){return n.apply(this,arguments)}}())})();